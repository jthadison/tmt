# Data Models

## Trading Account

**Purpose:** Represents a prop firm trading account with its configuration, credentials, and current state

**Key Attributes:**
- account_id: UUID - Unique system identifier
- prop_firm: String - Firm name (FTMO, MyForexFunds, etc.)
- account_number: String - External account identifier  
- legal_entity_id: UUID - Associated legal entity for compliance
- status: Enum - active, suspended, in_drawdown, terminated
- balance: Decimal - Current account balance
- equity: Decimal - Current equity including floating P&L
- max_daily_loss: Decimal - Daily loss limit from prop firm rules
- max_total_loss: Decimal - Maximum drawdown limit
- current_daily_pnl: Decimal - Today's profit/loss
- max_drawdown_reached: Decimal - Historical maximum drawdown
- personality_profile_id: UUID - Associated trading personality
- created_at: DateTime - Account creation timestamp
- updated_at: DateTime - Last modification timestamp

**Relationships:**
- Has many Positions (one-to-many)
- Has many Trade executions (one-to-many) 
- Belongs to one LegalEntity (many-to-one)
- Has one PersonalityProfile (one-to-one)

## Position

**Purpose:** Represents an active or closed trading position with all associated metadata

**Key Attributes:**
- position_id: UUID - Unique position identifier
- account_id: UUID - Associated trading account
- symbol: String - Trading pair (EURUSD, GBPUSD, etc.)
- position_type: Enum - long, short
- volume: Decimal - Position size in lots
- entry_price: Decimal - Position entry price
- current_price: Decimal - Current market price
- stop_loss: Decimal - Stop loss level
- take_profit: Decimal - Take profit level
- unrealized_pnl: Decimal - Current floating profit/loss
- realized_pnl: Decimal - Realized profit/loss when closed
- status: Enum - open, closed, partial
- entry_time: DateTime - Position open timestamp
- exit_time: DateTime - Position close timestamp (if closed)
- wyckoff_phase: String - Market phase when entered
- confidence_score: Float - Signal confidence (0-100)
- risk_reward_ratio: Float - Expected risk/reward ratio

**Relationships:**
- Belongs to one TradingAccount (many-to-one)
- Has many TradeExecutions (one-to-many)
- Generated by one TradingSignal (many-to-one)

## Trading Signal

**Purpose:** Represents a generated trading opportunity with analysis metadata

**Key Attributes:**
- signal_id: UUID - Unique signal identifier  
- symbol: String - Trading pair
- signal_type: Enum - buy, sell
- confidence_score: Float - Signal strength (0-100)
- entry_price: Decimal - Recommended entry price
- stop_loss: Decimal - Recommended stop loss
- take_profit: Decimal - Recommended take profit
- risk_reward_ratio: Float - Calculated risk/reward
- wyckoff_phase: String - Detected market phase
- pattern_type: String - Pattern that triggered signal
- volume_confirmation: Boolean - Volume confirms pattern
- timeframe: String - Analysis timeframe (M5, H1, H4)
- generated_at: DateTime - Signal creation time
- expires_at: DateTime - Signal expiration time
- status: Enum - active, executed, expired, rejected

**Relationships:**
- Can generate multiple Positions (one-to-many)
- Created by MarketAnalysisAgent

## Agent State

**Purpose:** Tracks the current state and configuration of each AI agent

**Key Attributes:**
- agent_id: UUID - Unique agent identifier
- agent_type: Enum - market_analysis, risk_management, execution, etc.
- status: Enum - active, inactive, error, maintenance
- configuration: JSONB - Agent-specific parameters
- performance_metrics: JSONB - Success rates, response times
- last_heartbeat: DateTime - Health check timestamp
- error_count: Integer - Recent error count
- version: String - Agent version/model version
- learning_enabled: Boolean - Whether agent can adapt
- circuit_breaker_status: Enum - normal, warning, tripped

**Relationships:**
- Generates TradingSignals (one-to-many)
- Has many AgentDecisions (one-to-many)

## Personality Profile  

**Purpose:** Defines unique trading personality characteristics for anti-detection

**Key Attributes:**
- personality_id: UUID - Unique identifier
- name: String - Personality name/identifier
- risk_appetite: Float - Risk tolerance (0.5-2.0%)
- preferred_pairs: JSON Array - Favorite trading pairs
- trading_sessions: JSON Array - Preferred trading times
- aggression_level: Float - Trading aggressiveness (0-1)
- patience_score: Float - Willingness to wait for setups (0-1)
- favorite_timeframes: JSON Array - Preferred analysis timeframes
- position_hold_preference: String - scalper, day_trader, swing_trader
- variance_tolerance: Float - Acceptable execution variance
- created_at: DateTime - Profile creation time

**Relationships:**
- Used by one TradingAccount (one-to-one)
- Influences multiple TradeExecutions
